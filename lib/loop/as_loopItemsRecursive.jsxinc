// Copyright (c) 2019 Oleksandr Semeniuk
// This code is licensed under MIT license
// See also http://www.opensource.org/licenses/mit-license.php

// version: 1.0.0
// date: Jul 22 2019

/**
 * 
 * @param {FolderItem} folder 
 * @param {boolean} intoSubfolders 
 * @param {Function} func 
 * @param {array} args 
 * @param {array} filterItemsNames 
 * @param {array} filterItemsTypes as_ItemType
 */
function as_loopItemsRecursive(folder, intoSubfolders, func, args, filterItemsNames, filterItemsTypes) {
    
    // CHECK ARGS
    if(args === undefined) {
        args = [];
    }

    // VARS
    var results = [];

    // LOOP ITEMS
    for (var i = 1, item; i <= folder.numItems; i++) {
        item = folder.item(i);

        // CHECK
        var nameMatch = (filterItemsNames === undefined) || (as_arrayCheckValue(item.name, filterItemsNames) >= 0);
        var typeMatch = (filterItemsTypes === undefined) || (as_arrayCheckValue(as_itemGetType(item), filterItemsTypes) >= 0);
        
        // DO
        if(nameMatch && typeMatch) {
            results.push(func.apply(undefined, [item].concat(args)));
        }

        // SUBFOLDERS
        if((item instanceof FolderItem) && intoSubfolders) {
            results = results.concat(as_loopItemsRecursive(item, intoSubfolders, func, args, filterItemsNames, filterItemsTypes));
        }
    }

    // RETURN
    return results;
}